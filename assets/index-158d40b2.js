import{L as V}from"./LayoutFooter-57b1b083.js";import{a as I,u as b,g as L}from"./index-498bb32d.js";import{w as D}from"./use-expose-287cc7e0.js";import{_ as S}from"./_plugin-vue_export-helper-c27b6911.js";import{C as y}from"./index-a594e45b.js";import{y as _,o as d,a$ as f,k as l,aI as a,b6 as k,aZ as c,a_ as g,b0 as w,b1 as B,G as x,b2 as N,c as C,aY as v,D as E,S as $}from"./index-5c77cc65.js";import{S as A}from"./index-758104da.js";import{N as R}from"./index-f0590db4.js";import{E as T}from"./index-b65cf528.js";import{S as U}from"./index-0dde73ad.js";/* empty css              */import"./index-b94a4d8e.js";import"./use-placeholder-b9738b46.js";import"./interceptor-b6b597e5.js";import"./use-route-7932d44a.js";import"./index-2507f749.js";import"./index-53e0e9c6.js";const F=o=>(w("data-v-2a7159ba"),o=o(),B(),o),P={class:"cart-item"},j=["src"],q={class:"info"},z=["textContent"],G={class:"detail"},M={class:"price"},O=F(()=>c("p",{class:"del"},[c("span",null,"删除")],-1)),Y={__name:"CartItem",props:{itemData:{type:Object,required:!0}},setup(o){const{itemData:r}=o,s=I(),m=b(),u=_({get:()=>r.checked,set:n=>{m.commit("cart/checkedChange",{checked:n,id:r.id})}}),i=_({get:()=>r.count,set:n=>{m.dispatch("cart/countChange",{count:n,id:r.id})}}),h=()=>{s.push({name:"product",params:{productId:r.productId}})};return(n,e)=>(d(),f("div",P,[l(a(y),{modelValue:a(u),"onUpdate:modelValue":e[0]||(e[0]=t=>k(u)?u.value=t:null),"checked-color":"#ee0a24"},null,8,["modelValue"]),c("div",{class:"link",onClick:h},[c("img",{src:o.itemData.image},null,8,j),c("div",q,[c("p",{class:"title",textContent:g(o.itemData.title)},null,8,z),c("p",G,[c("span",M,"￥"+g(o.itemData.price),1),l(a(A),{modelValue:a(i),"onUpdate:modelValue":e[1]||(e[1]=t=>k(i)?i.value=t:null),onClick:e[2]||(e[2]=D(()=>{},["stop"])),max:o.itemData.stock,"button-size":"26px"},null,8,["modelValue","max"])]),O])])]))}},Z=S(Y,[["__scopeId","data-v-2a7159ba"]]);const H={key:0,class:"cart-list"},J={__name:"index",setup(o){const r=I(),s=b(),m=_(()=>s.state.cart.cartList),u=_(()=>m.value.length),i=_({get:()=>s.getters["cart/checkedAll"],set(e){s.commit("cart/changeAll",{checked:e})}});(async()=>{const{data:e}=await L();e.status===200&&(s.commit("cart/clear"),await E(),e.data.valid.forEach(t=>{s.commit("cart/addToCart",{id:t.id,checked:!0,count:t.cart_num,image:t.productInfo.image,title:t.productInfo.store_name,price:t.truePrice,stock:t.trueStock,productId:t.product_id})}))})();const n=()=>{r.push({name:"order-confirm",params:{cartId:s.getters["cart/checkedItems"].map(e=>e.id).toString()}})};return(e,t)=>(d(),f(x,null,[l(a(R),{onClickLeft:t[0]||(t[0]=p=>a(r).go(-1)),title:"购物车","left-arrow":""}),a(u)?(d(),f("div",H,[(d(!0),f(x,null,N(a(m),p=>(d(),C(Z,{key:p.id,"item-data":p},null,8,["item-data"]))),128))])):(d(),C(a(T),{key:1,description:"购物车空空如也..."})),l(a(U),{price:a(s).getters["cart/totalPrice"]*100,"button-text":"去结算",onSubmit:n},{default:v(()=>[l(a(y),{modelValue:a(i),"onUpdate:modelValue":t[1]||(t[1]=p=>k(i)?i.value=p:null),"checked-color":"#ee0a24"},{default:v(()=>[$(" 全选 ")]),_:1},8,["modelValue"])]),_:1},8,["price"]),l(V)],64))}},pt=S(J,[["__scopeId","data-v-73960e8c"]]);export{pt as default};
