import{a as G}from"./index-4d1704fc.js";import{g as O,c as T,a as U}from"./order-26b9eae4.js";import{_ as F}from"./_plugin-vue_export-helper-c27b6911.js";import{g as i,y as m,o as _,a$ as w,k as s,aI as t,aZ as l,a_ as u,b3 as q,aY as n,G as A,b4 as Y,b2 as K,c as M,Y as k,S as Z}from"./index-5c77cc65.js";import{S as j}from"./index-0dde73ad.js";import{A as H,b as J,R as Q,a as C}from"./index-1113fddf.js";import{E as W}from"./index-b65cf528.js";import{a as b,C as c}from"./index-bae722f2.js";import{N as X}from"./index-f0590db4.js";import{P as ee}from"./index-8b00a7b6.js";import{B as te}from"./index-2507f749.js";import{T as V}from"./function-call-6e103baf.js";import"./index-53e0e9c6.js";import"./use-expose-287cc7e0.js";import"./use-route-7932d44a.js";import"./use-placeholder-b9738b46.js";import"./use-touch-38e3a584.js";import"./on-popup-reopen-e5c081b4.js";import"./interceptor-b6b597e5.js";const ae={class:"container"},se={class:"info"},oe=["textContent"],ne=["textContent"],le={class:"detail"},re={key:0,class:"default"},ie=["textContent"],de={class:"product-list"},ue=["src"],ce={class:"info"},pe=["textContent"],me={class:"price"},fe={class:"count"},_e={__name:"index",props:{cartId:{type:String,required:!0}},setup(P){const{cartId:v}=P,g=G(),f=i(!1),y=i(""),h=i([]),r=i([]),p=i({}),I=m(()=>{var a;return(a=p.value)==null?void 0:a.cartInfo}),S=m(()=>{var a;return`共${((a=I.value)==null?void 0:a.length)||0}件`}),B=m(()=>{var a,e;return(((e=(a=p.value)==null?void 0:a.priceGroup)==null?void 0:e.totalPrice)||0)*100}),x=i(!1),d=i("yue"),L=m(()=>{var a;return(a=p.value)==null?void 0:a.userInfo.now_money}),$=a=>a.map(e=>{const o={id:e.id,name:e.real_name,tel:e.phone,address:e.province+e.city+e.district+e.detail,isDefault:e.is_default};return e.is_default===1&&(y.value=e.id,r.value=o),o});(async()=>{const{data:a}=await O();a.status===200&&(h.value=$(a.data))})();const R=()=>{f.value=!0},z=m(()=>h.value.length===0),N=a=>{f.value=!1,r.value=a},D=()=>{g.push({name:"address",params:{cartId:v}})};(async()=>{const{data:a}=await T({cartId:v,new:0});a.status===200&&(p.value=a.data)})();const E=async()=>{var e;const{data:a}=await U((e=p.value)==null?void 0:e.orderKey,{addressId:r.value.id,payType:d.value});a.status===200&&(console.log(a),a.msg==="余额支付成功"?(V.success("支付成功！即将跳转..."),g.push({name:"order",params:{cartId:v},query:{orderId:a.data.result.orderId}})):V("余额不足！"))};return(a,e)=>(_(),w(A,null,[s(t(X),{onClickLeft:e[0]||(e[0]=o=>t(g).go(-1)),title:"订单确认","left-text":"返回","left-arrow":""}),l("div",ae,[l("div",{class:"address-card",onClick:R},[l("p",se,[l("span",{class:"username",textContent:u(r.value.name)},null,8,oe),l("span",{textContent:u(r.value.tel)},null,8,ne)]),l("p",le,[r.value.isDefault?(_(),w("span",re,"[默认]")):q("",!0),l("span",{textContent:u(r.value.address)},null,8,ie)])]),s(t(ee),{show:f.value,"onUpdate:show":e[2]||(e[2]=o=>f.value=o),position:"bottom"},{default:n(()=>[s(t(J),{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=o=>y.value=o),list:h.value,"disabled-list":a.disabledList,"default-tag-text":"默认",onAdd:D,onClickItem:N},Y({_:2},[t(z)?{name:"top",fn:n(()=>[s(t(W),{description:"还没有地址哦.."})]),key:"0"}:void 0]),1032,["modelValue","list","disabled-list"])]),_:1},8,["show"]),l("div",de,[s(t(b),null,{default:n(()=>[s(t(c),{title:t(S)},null,8,["title"])]),_:1}),s(t(b),null,{default:n(()=>[(_(!0),w(A,null,K(t(I),o=>(_(),M(t(c),{class:"product",key:o.id},{default:n(()=>[l("img",{src:o.productInfo.image},null,8,ue),l("div",ce,[l("p",{class:"title",textContent:u(o.productInfo.store_name)},null,8,pe),l("p",me," ￥"+u(o.truePrice),1)]),l("span",fe,"x"+u(o.cart_num),1)]),_:2},1024))),128))]),_:1})])]),s(t(j),{label:"订单总计：",price:t(B),"button-text":"立即付款",onSubmit:e[3]||(e[3]=o=>x.value=!0)},null,8,["price"]),s(t(H),{show:x.value,"onUpdate:show":e[8]||(e[8]=o=>x.value=o),"cancel-text":"取消","close-on-click-action":"",title:"请选择支付方式"},{default:n(()=>[s(t(Q),{modelValue:d.value,"onUpdate:modelValue":e[7]||(e[7]=o=>d.value=o)},{default:n(()=>[s(t(b),{inset:""},{default:n(()=>[s(t(c),{clickable:"",title:"微信支付",label:"微信快捷支付",onClick:e[4]||(e[4]=o=>d.value="wechat"),size:"large",center:""},{icon:n(()=>[s(t(k),{name:"http://www.lgstatic.com/lg-app-fed/pay/images/wechat_b787e2f4.png",size:"30",style:{marginRight:"12px"}})]),"right-icon":n(()=>[s(t(C),{name:"wechat","checked-color":"#ee0a24"})]),_:1}),s(t(c),{clickable:"",title:"支付宝",label:"支付宝快捷支付",onClick:e[5]||(e[5]=o=>d.value="alipay"),size:"large",center:""},{icon:n(()=>[s(t(k),{name:"http://www.lgstatic.com/lg-app-fed/pay/images/ali_ed78fdae.png",size:"30",style:{marginRight:"12px"}})]),"right-icon":n(()=>[s(t(C),{name:"alipay","checked-color":"#ee0a24"})]),_:1}),s(t(c),{clickable:"",title:"余额",label:`可用余额为：${t(L)}`,onClick:e[6]||(e[6]=o=>d.value="yue"),size:"large",center:""},{icon:n(()=>[s(t(k),{name:"gold-coin",color:"#FF9900",size:"30",style:{marginRight:"12px"}})]),"right-icon":n(()=>[s(t(C),{name:"yue","checked-color":"#ee0a24"})]),_:1},8,["label"]),s(t(c),null,{default:n(()=>[s(t(te),{round:"",block:"",type:"danger",onClick:E},{default:n(()=>[Z(" 去支付 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["show"])],64))}},Ee=F(_e,[["__scopeId","data-v-31433785"]]);export{Ee as default};
