import{b as D,n as T,v as B,q as E,t as L,e as U,d as Y,y as G,aj as J,k as u,p as K,Y as N,M as O,L as Q,A as W}from"./index-5c77cc65.js";import{u as Z}from"./use-refs-988793b1.js";import{u as $}from"./use-touch-38e3a584.js";const[x,d]=D("rate");function p(e,o,l,i){return e>=o?{status:"full",value:1}:e+.5>=o&&l&&!i?{status:"half",value:.5}:e+1>=o&&l&&i?{status:"half",value:Math.round((e-o+1)*1e10)/1e10}:{status:"void",value:0}}const ee={size:T,icon:B("star"),color:String,count:E(5),gutter:T,readonly:Boolean,disabled:Boolean,voidIcon:B("star-o"),allowHalf:Boolean,voidColor:String,touchable:L,iconPrefix:String,modelValue:U(0),disabledColor:String};var ae=Y({name:x,props:ee,emits:["change","update:modelValue"],setup(e,{emit:o}){const l=$(),[i,h]=Z(),v=()=>e.readonly||e.disabled||!e.touchable,M=G(()=>Array(+e.count).fill("").map((a,t)=>p(e.modelValue,t+1,e.allowHalf,e.readonly)));let s;const b=()=>{const a=i.value.map(O);s=[],a.forEach((t,n)=>{e.allowHalf?s.push({score:n+.5,left:t.left},{score:n+1,left:t.left+t.width/2}):s.push({score:n+1,left:t.left})})},g=a=>{for(let t=s.length-1;t>0;t--)if(a>s[t].left)return s[t].score;return e.allowHalf?.5:1},y=a=>{!e.disabled&&!e.readonly&&a!==e.modelValue&&(o("update:modelValue",a),o("change",a))},A=a=>{v()||(l.start(a),b())},F=a=>{if(!v()&&(l.move(a),l.isHorizontal())){const{clientX:t}=a.touches[0];K(a),y(g(t))}},X=(a,t)=>{const{icon:n,size:P,color:R,count:S,gutter:V,voidIcon:k,disabled:r,voidColor:C,allowHalf:w,iconPrefix:z,disabledColor:H}=e,f=t+1,m=a.status==="full",c=a.status==="void",_=w&&a.value>0&&a.value<1;let I;V&&f!==+S&&(I={paddingRight:Q(V)});const j=q=>{b(),y(w?g(q.clientX):f)};return u("div",{key:t,ref:h(t),role:"radio",style:I,class:d("item"),tabindex:r?void 0:0,"aria-setsize":S,"aria-posinset":f,"aria-checked":!c,onClick:j},[u(N,{size:P,name:m?n:k,class:d("icon",{disabled:r,full:m}),color:r?H:m?R:C,classPrefix:z},null),_&&u(N,{size:P,style:{width:a.value+"em"},name:c?k:n,class:d("icon",["half",{disabled:r,full:!c}]),color:r?H:c?C:R,classPrefix:z},null)])};return J(()=>e.modelValue),()=>u("div",{role:"radiogroup",class:d({readonly:e.readonly,disabled:e.disabled}),tabindex:e.disabled?void 0:0,"aria-disabled":e.disabled,"aria-readonly":e.readonly,onTouchstart:A,onTouchmove:F},[M.value.map(X)])}});const se=W(ae);export{se as R};
