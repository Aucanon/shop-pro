import{C as F}from"./CommentItem-fed762d8.js";import{a as Z}from"./product-b4eabe96.js";import{a as j,u as J,o as K,d as O}from"./index-4d1704fc.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";import{T as W,a as w}from"./index-ceb5fe59.js";import{a as X,b,A}from"./index-bc624e64.js";import{g as tt,y as i,h as et,o as _,a$ as v,k as o,aI as t,aY as s,G as x,b2 as k,c as I,aZ as n,a_ as c,Y as ot,b5 as st,b3 as at,b0 as nt,b1 as lt}from"./index-5c77cc65.js";import{S as rt}from"./index-758104da.js";import{N as ut}from"./index-f0590db4.js";import{a as ct,S as it}from"./index-a5da3e41.js";import{C as f,a as N}from"./index-bae722f2.js";import{P as pt}from"./index-8b00a7b6.js";import{G as dt,a as mt}from"./index-6df4a39e.js";import{I as _t}from"./index-43f4aa3f.js";import{T as ft}from"./function-call-6e103baf.js";/* empty css              */import"./index-49f6cb3d.js";import"./use-refs-988793b1.js";import"./use-touch-38e3a584.js";import"./use-expose-287cc7e0.js";import"./use-id-ae6cda1c.js";import"./use-route-7932d44a.js";import"./on-popup-reopen-e5c081b4.js";import"./interceptor-b6b597e5.js";import"./index-2507f749.js";import"./index-53e0e9c6.js";import"./use-placeholder-b9738b46.js";const ht=C=>(nt("data-v-2e330160"),C=C(),lt(),C),vt=["src"],Ct={class:"price"},yt=["textContent"],xt=["src"],gt={class:"info"},wt=["textContent"],kt={class:"price"},It={class:"stock"},bt=["textContent"],St=["onClick","textContent"],Tt=ht(()=>n("p",{class:"title"}," 推荐商品 ",-1)),Bt=["textContent"],Vt=["innerHTML"],At={__name:"index",props:{productId:{type:String,required:!0}},setup(C){const{productId:S}=C,g=j(),P=J(),p=tt({}),T=async()=>{const{data:a}=await Z(S);if(a.status!==200){g.push({name:"home"});return}p.value=a.data,E(a.data.productAttr)};T(),console.log(p.value.storeInfo);const d=i(()=>p.value.storeInfo),D=i(()=>{var a;return(a=d.value)==null?void 0:a.slider_image}),B=i(()=>p.value.replyCount||0),G=i(()=>`用户评价（${B.value}）`),L=i(()=>p.value.replyChance||0),q=i(()=>L.value+"%好评率"),R=i(()=>p.value.reply),$=i(()=>p.value.good_list);K(a=>{p.value={},document.body.scrollTop=0,document.documentElement.scrollTop=0,T(a.params.productId)});const H=i(()=>p.value.productAttr),U=i(()=>p.value.productValue),r=et({show:!1,spec:[],buyCount:0}),V=i(()=>r.spec.toString()),y=i(()=>{var a;return(a=U.value)==null?void 0:a[V.value]}),z=()=>{r.show=!r.show},E=a=>{r.spec=a.map(u=>u.attr_values[0])},M=(a,u)=>{r.spec[u]=a},Y=async()=>{var u;if(P.state.user||g.push({name:"login",query:{redirect:g.currentRoute.value.fullPath}}),!r.show){r.show=!0;return}const{data:a}=await O({new:0,uniqueId:(u=y.value)==null?void 0:u.unique,productId:S,cartNum:r.buyCount});a.status===200&&(r.show=!1,ft("加入购物车成功！"))};return(a,u)=>(_(),v(x,null,[o(t(ut),{"left-arrow":"",fixed:"",onClickLeft:u[0]||(u[0]=e=>t(g).go(-1))}),o(t(W),{scrollspy:"",color:"#fbc546"},{default:s(()=>[o(t(w),{title:"商品"},{default:s(()=>[o(t(ct),{autoplay:3e3,width:"375",height:"375"},{default:s(()=>[(_(!0),v(x,null,k(t(D),(e,l)=>(_(),I(t(it),{key:l},{default:s(()=>[n("img",{src:e},null,8,vt)]),_:2},1024))),128))]),_:1}),o(t(f),{class:"productHeader",border:!1},{title:s(()=>{var e,l;return[n("div",Ct,[n("span",null,"￥"+c((e=t(d))==null?void 0:e.price),1),o(t(ot),{name:"share-o",size:"20",class:"share"})]),n("div",{class:"title",textContent:c((l=t(d))==null?void 0:l.store_name)},null,8,yt)]}),label:s(()=>{var e,l,m,h;return[n("span",null,"原价￥"+c((e=t(d))==null?void 0:e.ot_price),1),n("span",null,"库存："+c(((l=t(d))==null?void 0:l.stock)+((m=t(d))==null?void 0:m.unit_name)),1),n("span",null,"销量："+c((h=t(d))==null?void 0:h.fsales),1)]}),_:1}),o(t(f),{"is-link":"",class:"sku_window",onClick:z},{title:s(()=>[n("span",null,"已选择："+c(t(V)),1)]),_:1}),o(t(pt),{show:r.show,"onUpdate:show":u[2]||(u[2]=e=>r.show=e),position:"bottom",class:"popup",round:!0},{default:s(()=>[o(t(N),null,{default:s(()=>[o(t(f),{class:"popup-header"},{default:s(()=>{var e,l,m,h;return[n("img",{src:(e=t(y))==null?void 0:e.image},null,8,xt),n("div",gt,[n("p",{class:"title",textContent:c((l=t(d))==null?void 0:l.store_name)},null,8,wt),n("p",kt," ￥"+c((m=t(y))==null?void 0:m.price),1),n("p",It," 库存："+c((h=t(y))==null?void 0:h.stock),1)])]}),_:1}),(_(!0),v(x,null,k(t(H),(e,l)=>(_(),I(t(f),{class:"spec",key:e.id},{default:s(()=>[n("p",{textContent:c(e.attr_name)},null,8,bt),(_(!0),v(x,null,k(e.attr_values,m=>(_(),v("span",{onClick:h=>M(m,l),class:st([{active:r.spec[l]===m},"tag"]),key:m.id,textContent:c(m)},null,10,St))),128))]),_:2},1024))),128)),o(t(f),{title:"数量"},{default:s(()=>{var e;return[o(t(rt),{modelValue:r.buyCount,"onUpdate:modelValue":u[1]||(u[1]=l=>r.buyCount=l),max:(e=t(y))==null?void 0:e.stock},null,8,["modelValue","max"])]}),_:1})]),_:1})]),_:1},8,["show"])]),_:1}),o(t(w),{title:"评价",class:"comment"},{default:s(()=>[o(t(N),null,{default:s(()=>{var e;return[o(t(f),{"is-link":"",title:t(G),value:t(q),to:{name:"comment",params:{productId:(e=t(d))==null?void 0:e.id}}},null,8,["title","value","to"]),t(B)!==0?(_(),I(F,{key:0,reply:t(R)},null,8,["reply"])):at("",!0)]}),_:1})]),_:1}),o(t(w),{title:"推荐"},{default:s(()=>[o(t(f),{class:"recommend"},{default:s(()=>[Tt,o(t(dt),{border:!1,"colum-num":3},{default:s(()=>[(_(!0),v(x,null,k(t($),e=>(_(),I(t(mt),{key:e.id,to:{name:"product",params:{productId:e.id}}},{default:s(()=>[o(t(_t),{src:e.image},null,8,["src"]),n("p",{textContent:c(e.store_name)},null,8,Bt),n("span",null,"￥"+c(e.price),1)]),_:2},1032,["to"]))),128))]),_:1})]),_:1})]),_:1}),o(t(w),{title:"详情"},{default:s(()=>{var e;return[n("div",{class:"description",innerHTML:(e=t(d))==null?void 0:e.description},null,8,Vt)]}),_:1})]),_:1}),o(t(X),null,{default:s(()=>[o(t(b),{icon:"chat-o",text:"客服",color:"#ee0a24"}),o(t(b),{icon:"cart-o",text:"购物车",to:"/cart"}),o(t(b),{icon:"star",text:"已收藏",color:"#ff5000"}),o(t(A),{onClick:Y,type:"warning",text:"加入购物车"}),o(t(A),{type:"danger",text:"立即购买"})]),_:1})],64))}},ae=Q(At,[["__scopeId","data-v-2e330160"]]);export{ae as default};
