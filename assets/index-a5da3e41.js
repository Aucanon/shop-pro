import{b as j,t as _,n as K,q as D,d as L,g as le,h as U,x as ce,y as h,w as x,a9 as ue,$ as re,aW as ve,C as V,aL as fe,aK as he,ah as de,k as A,W as z,ac as N,D as q,p as me,l as O,A as F,aH as ge,j as we}from"./index-5c77cc65.js";import{u as pe}from"./use-touch-38e3a584.js";import{u as G}from"./use-expose-287cc7e0.js";import{o as ye}from"./on-popup-reopen-e5c081b4.js";const[J,I]=j("swipe"),be={loop:_,width:K,height:K,vertical:Boolean,autoplay:D(0),duration:D(500),touchable:_,lazyRender:Boolean,initialSwipe:D(0),indicatorColor:String,showIndicators:_,stopPropagation:_},Q=Symbol(J);var Te=L({name:J,props:be,emits:["change"],setup(a,{emit:C,slots:d}){const u=le(),e=U({rect:null,width:0,height:0,offset:0,active:0,swiping:!1}),l=pe(),{children:m,linkChildren:M}=ce(Q),i=h(()=>m.length),n=h(()=>e[a.vertical?"height":"width"]),r=h(()=>a.vertical?l.deltaY.value:l.deltaX.value),f=h(()=>e.rect?(a.vertical?e.rect.height:e.rect.width)-n.value*i.value:0),P=h(()=>Math.ceil(Math.abs(f.value)/n.value)),y=h(()=>i.value*n.value),w=h(()=>(e.active+i.value)%i.value),B=h(()=>{const t=a.vertical?"vertical":"horizontal";return l.direction.value===t}),Z=h(()=>{const t={transitionDuration:`${e.swiping?0:a.duration}ms`,transform:`translate${a.vertical?"Y":"X"}(${e.offset}px)`};if(n.value){const s=a.vertical?"height":"width",o=a.vertical?"width":"height";t[s]=`${y.value}px`,t[o]=a[o]?`${a[o]}px`:""}return t}),ee=t=>{const{active:s}=e;return t?a.loop?O(s+t,-1,i.value):O(s+t,0,P.value):s},E=(t,s=0)=>{let o=t*n.value;a.loop||(o=Math.min(o,-f.value));let v=s-o;return a.loop||(v=O(v,f.value,0)),v},g=({pace:t=0,offset:s=0,emitChange:o})=>{if(i.value<=1)return;const{active:v}=e,c=ee(t),S=E(c,s);if(a.loop){if(m[0]&&S!==f.value){const k=S<f.value;m[0].setOffset(k?y.value:0)}if(m[i.value-1]&&S!==0){const k=S>0;m[i.value-1].setOffset(k?-y.value:0)}}e.active=c,e.offset=S,o&&c!==v&&C("change",w.value)},$=()=>{e.swiping=!0,e.active<=-1?g({pace:i.value}):e.active>=i.value&&g({pace:-i.value})},te=()=>{$(),l.reset(),z(()=>{e.swiping=!1,g({pace:-1,emitChange:!0})})},R=()=>{$(),l.reset(),z(()=>{e.swiping=!1,g({pace:1,emitChange:!0})})};let Y;const b=()=>clearTimeout(Y),T=()=>{b(),a.autoplay>0&&i.value>1&&(Y=setTimeout(()=>{R(),T()},+a.autoplay))},p=(t=+a.initialSwipe)=>{if(!u.value)return;const s=()=>{var o,v;if(!N(u)){const c={width:u.value.offsetWidth,height:u.value.offsetHeight};e.rect=c,e.width=+((o=a.width)!=null?o:c.width),e.height=+((v=a.height)!=null?v:c.height)}i.value&&(t=Math.min(i.value-1,t)),e.active=t,e.swiping=!0,e.offset=E(t),m.forEach(c=>{c.setOffset(0)}),T()};N(u)?q().then(s):s()},W=()=>p(e.active);let H;const ae=t=>{!a.touchable||(l.start(t),H=Date.now(),b(),$())},ie=t=>{a.touchable&&e.swiping&&(l.move(t),B.value&&(me(t,a.stopPropagation),g({offset:r.value})))},X=()=>{if(!a.touchable||!e.swiping)return;const t=Date.now()-H,s=r.value/t;if((Math.abs(s)>.25||Math.abs(r.value)>n.value/2)&&B.value){const v=a.vertical?l.offsetY.value:l.offsetX.value;let c=0;a.loop?c=v>0?r.value>0?-1:1:0:c=-Math[r.value>0?"ceil":"floor"](r.value/n.value),g({pace:c,emitChange:!0})}else r.value&&g({pace:0});e.swiping=!1,T()},ne=(t,s={})=>{$(),l.reset(),z(()=>{let o;a.loop&&t===i.value?o=e.active===0?0:t:o=t%i.value,s.immediate?z(()=>{e.swiping=!1}):e.swiping=!1,g({pace:o-e.active,emitChange:!0})})},oe=(t,s)=>{const o=s===w.value,v=o?{backgroundColor:a.indicatorColor}:void 0;return A("i",{style:v,class:I("indicator",{active:o})},null)},se=()=>{if(d.indicator)return d.indicator({active:w.value,total:i.value});if(a.showIndicators&&i.value>1)return A("div",{class:I("indicators",{vertical:a.vertical})},[Array(i.value).fill("").map(oe)])};return G({prev:te,next:R,state:e,resize:W,swipeTo:ne}),M({size:n,props:a,count:i,activeIndicator:w}),x(()=>a.initialSwipe,t=>p(+t)),x(i,()=>p(e.active)),x(()=>a.autoplay,T),x([ue,re],W),x(ve(),t=>{t==="visible"?T():b()}),V(p),fe(()=>p(e.active)),ye(()=>p(e.active)),he(b),de(b),()=>{var t;return A("div",{ref:u,class:I()},[A("div",{style:Z.value,class:I("track",{vertical:a.vertical}),onTouchstart:ae,onTouchmove:ie,onTouchend:X,onTouchcancel:X},[(t=d.default)==null?void 0:t.call(d)]),se()])}}});const Ie=F(Te),Se=Symbol(),Me=()=>ge(Se,null),[xe,Ae]=j("swipe-item");var Ce=L({name:xe,setup(a,{slots:C}){let d;const u=U({offset:0,inited:!1,mounted:!1}),{parent:e,index:l}=we(Q);if(!e)return;const m=h(()=>{const n={},{vertical:r}=e.props;return e.size.value&&(n[r?"height":"width"]=`${e.size.value}px`),u.offset&&(n.transform=`translate${r?"Y":"X"}(${u.offset}px)`),n}),M=h(()=>{const{loop:n,lazyRender:r}=e.props;if(!r||d)return!0;if(!u.mounted)return!1;const f=e.activeIndicator.value,P=e.count.value-1,y=f===0&&n?P:f-1,w=f===P&&n?0:f+1;return d=l.value===f||l.value===y||l.value===w,d}),i=n=>{u.offset=n};return V(()=>{q(()=>{u.mounted=!0})}),G({setOffset:i}),()=>{var n;return A("div",{class:Ae(),style:m.value},[M.value?(n=C.default)==null?void 0:n.call(C):null])}}});const ke=F(Ce);export{ke as S,Se as T,Ie as a,Me as u};
