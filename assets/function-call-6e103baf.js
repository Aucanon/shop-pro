import{c as L,u as D}from"./use-expose-287cc7e0.js";import{h as E,s as d,b as A,v as w,n as S,e as U,u as x,d as j,w as O,C as F,aJ as V,k as u,F as I,E as _,Y as q,i as H,a3 as J,A as Y,a as $,g as G,aF as K}from"./index-5c77cc65.js";import{P as Q}from"./index-8b00a7b6.js";import{L as R}from"./index-53e0e9c6.js";function W(){const e=E({show:!1}),t=s=>{e.show=s},n=s=>{d(e,s,{transitionAppear:!0}),t(!0)},c=()=>t(!1);return D({open:n,close:c,toggle:t}),{open:n,close:c,state:e,toggle:t}}function X(e){const t=L(e),n=document.createElement("div");return document.body.appendChild(n),{instance:t.mount(n),unmount(){t.unmount(),document.body.removeChild(n)}}}let m=0;function Z(e){e?(m||document.body.classList.add("van-toast--unclickable"),m++):m&&(m--,m||document.body.classList.remove("van-toast--unclickable"))}const[ee,p]=A("toast"),te=["show","overlay","transition","overlayClass","overlayStyle","closeOnClickOverlay"],ne={icon:String,show:Boolean,type:w("text"),overlay:Boolean,message:S,iconSize:S,duration:U(2e3),position:w("middle"),className:x,iconPrefix:String,transition:w("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:x,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean};var T=j({name:ee,props:ne,emits:["update:show"],setup(e,{emit:t}){let n,c=!1;const s=()=>{const i=e.show&&e.forbidClick;c!==i&&(c=i,Z(c))},f=i=>t("update:show",i),C=()=>{e.closeOnClick&&f(!1)},g=()=>clearTimeout(n),k=()=>{const{icon:i,type:l,iconSize:P,iconPrefix:N,loadingType:z}=e;if(i||l==="success"||l==="fail")return u(q,{name:i||l,size:P,class:p("icon"),classPrefix:N},null);if(l==="loading")return u(R,{class:p("loading"),size:P,type:z},null)},r=()=>{const{type:i,message:l}=e;if(H(l)&&l!=="")return i==="html"?u("div",{class:p("text"),innerHTML:String(l)},null):u("div",{class:p("text")},[l])};return O(()=>[e.show,e.forbidClick],s),O(()=>[e.show,e.type,e.message,e.duration],()=>{g(),e.show&&e.duration>0&&(n=setTimeout(()=>{f(!1)},e.duration))}),F(s),V(s),()=>u(Q,I({class:[p([e.position,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:C,onClosed:g,"onUpdate:show":f},_(e,te)),{default:()=>[k(),r()]})}});const M={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let o=[],h=!1,v=d({},M);const y=new Map;function B(e){return $(e)?e:{message:e}}function oe(){const{instance:e,unmount:t}=X({setup(){const n=G(""),{open:c,state:s,close:f,toggle:C}=W(),g=()=>{h&&(o=o.filter(r=>r!==e),t())},k=()=>u(T,I(s,{onClosed:g,"onUpdate:show":C}),null);return O(n,r=>{s.message=r}),K().render=k,{open:c,clear:f,message:n}}});return e}function se(){if(!o.length||h){const e=oe();o.push(e)}return o[o.length-1]}function a(e={}){if(!J)return{};const t=se(),n=B(e);return t.open(d({},v,y.get(n.type||v.type),n)),t}const b=e=>t=>a(d({type:e},B(t)));a.loading=b("loading");a.success=b("success");a.fail=b("fail");a.clear=e=>{var t;o.length&&(e?(o.forEach(n=>{n.clear()}),o=[]):h?(t=o.shift())==null||t.clear():o[0].clear())};function ae(e,t){typeof e=="string"?y.set(e,t):d(v,e)}a.setDefaultOptions=ae;a.resetDefaultOptions=e=>{typeof e=="string"?y.delete(e):(v=d({},M),y.clear())};a.allowMultiple=(e=!0)=>{h=e};a.install=e=>{e.use(Y(T)),e.config.globalProperties.$toast=a};export{a as T,X as m,W as u};
