import{b as I,q as k,v as Y,t as F,d as B,g as P,a4 as M,w as H,aS as X,C as G,a6 as N,k as c,D as V,M as E,ac as J,A as C,h as A,P as O,J as Q,Y as L,W as _,Q as j,i as z,n as K,p as Z,R as p}from"./index-5c77cc65.js";import{u as W,v as ee}from"./use-expose-287cc7e0.js";import{u as te}from"./index-a5da3e41.js";import{L as q}from"./index-53e0e9c6.js";import{o as ne}from"./on-popup-reopen-e5c081b4.js";import{u as ae}from"./use-touch-38e3a584.js";const[oe,D,se]=I("list"),ie={error:Boolean,offset:k(300),loading:Boolean,finished:Boolean,errorText:String,direction:Y("down"),loadingText:String,finishedText:String,immediateCheck:F};var re=B({name:oe,props:ie,emits:["load","update:error","update:loading"],setup(e,{emit:m,slots:o}){const l=P(!1),d=P(),x=P(),n=te(),f=M(d),a=()=>{V(()=>{if(l.value||e.finished||e.error||(n==null?void 0:n.value)===!1)return;const{offset:i,direction:v}=e,u=E(f);if(!u.height||J(d))return;let r=!1;const g=E(x);v==="up"?r=u.top-g.top<=i:r=g.bottom-u.bottom<=i,r&&(l.value=!0,m("update:loading",!0),m("load"))})},S=()=>{if(e.finished){const i=o.finished?o.finished():e.finishedText;if(i)return c("div",{class:D("finished-text")},[i])}},R=()=>{m("update:error",!1),a()},h=()=>{if(e.error){const i=o.error?o.error():e.errorText;if(i)return c("div",{role:"button",class:D("error-text"),tabindex:0,onClick:R},[i])}},w=()=>{if(l.value&&!e.finished)return c("div",{class:D("loading")},[o.loading?o.loading():c(q,{class:D("loading-icon")},{default:()=>[e.loadingText||se("loading")]})])};return H(()=>[e.loading,e.finished,e.error],a),n&&H(n,i=>{i&&a()}),X(()=>{l.value=e.loading}),G(()=>{e.immediateCheck&&a()}),W({check:a}),N("scroll",a,{target:f}),()=>{var i;const v=(i=o.default)==null?void 0:i.call(o),u=c("div",{ref:x,class:D("placeholder")},null);return c("div",{ref:d,role:"feed",class:D(),"aria-busy":l.value},[e.direction==="down"?v:u,w(),S(),h(),e.direction==="up"?v:u])}}});const De=C(re),[le,y]=I("notice-bar"),ce={text:String,mode:String,color:String,delay:k(1),speed:k(60),leftIcon:String,wrapable:Boolean,background:String,scrollable:{type:Boolean,default:null}};var ue=B({name:le,props:ce,emits:["close","replay"],setup(e,{emit:m,slots:o}){let l=0,d=0,x;const n=P(),f=P(),a=A({show:!0,offset:0,duration:0}),S=()=>{if(o["left-icon"])return o["left-icon"]();if(e.leftIcon)return c(L,{class:y("left-icon"),name:e.leftIcon},null)},R=()=>{if(e.mode==="closeable")return"cross";if(e.mode==="link")return"arrow"},h=r=>{e.mode==="closeable"&&(a.show=!1,m("close",r))},w=()=>{if(o["right-icon"])return o["right-icon"]();const r=R();if(r)return c(L,{name:r,class:y("right-icon"),onClick:h},null)},i=()=>{a.offset=l,a.duration=0,j(()=>{_(()=>{a.offset=-d,a.duration=(d+l)/+e.speed,m("replay")})})},v=()=>{const r=e.scrollable===!1&&!e.wrapable,g={transform:a.offset?`translateX(${a.offset}px)`:"",transitionDuration:`${a.duration}s`};return c("div",{ref:n,role:"marquee",class:y("wrap")},[c("div",{ref:f,style:g,class:[y("content"),{"van-ellipsis":r}],onTransitionend:i},[o.default?o.default():e.text])])},u=()=>{const{delay:r,speed:g,scrollable:b}=e,t=z(r)?+r*1e3:0;l=0,d=0,a.offset=0,a.duration=0,clearTimeout(x),x=setTimeout(()=>{if(!n.value||!f.value||b===!1)return;const s=E(n).width,T=E(f).width;(b||T>s)&&_(()=>{l=s,d=T,a.offset=-d,a.duration=d/+g})},t)};return ne(u),O(u),N("pageshow",u),W({reset:u}),H(()=>[e.text,e.scrollable],u),()=>{const{color:r,wrapable:g,background:b}=e;return Q(c("div",{role:"alert",class:y({wrapable:g}),style:{color:r,background:b}},[S(),v(),w()]),[[ee,a.show]])}}});const ke=C(ue),[de,$,fe]=I("pull-refresh"),U=50,he=["pulling","loosing","success"],ge={disabled:Boolean,modelValue:Boolean,headHeight:k(U),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:K,successDuration:k(500),animationDuration:k(300)};var me=B({name:de,props:ge,emits:["refresh","update:modelValue"],setup(e,{emit:m,slots:o}){let l;const d=P(),x=M(d),n=A({status:"normal",distance:0,duration:0}),f=ae(),a=()=>{if(e.headHeight!==U)return{height:`${e.headHeight}px`}},S=()=>n.status!=="loading"&&n.status!=="success"&&!e.disabled,R=t=>{const s=+(e.pullDistance||e.headHeight);return t>s&&(t<s*2?t=s+(t-s)/2:t=s*1.5+(t-s*2)/4),Math.round(t)},h=(t,s)=>{const T=+(e.pullDistance||e.headHeight);n.distance=t,s?n.status="loading":t===0?n.status="normal":t<T?n.status="pulling":n.status="loosing"},w=()=>{const{status:t}=n;return t==="normal"?"":e[`${t}Text`]||fe(t)},i=()=>{const{status:t,distance:s}=n;if(o[t])return o[t]({distance:s});const T=[];return he.includes(t)&&T.push(c("div",{class:$("text")},[w()])),t==="loading"&&T.push(c(q,{class:$("loading")},{default:w})),T},v=()=>{n.status="success",setTimeout(()=>{h(0)},+e.successDuration)},u=t=>{l=p(x.value)===0,l&&(n.duration=0,f.start(t))},r=t=>{S()&&u(t)},g=t=>{if(S()){l||u(t);const{deltaY:s}=f;f.move(t),l&&s.value>=0&&f.isVertical()&&(Z(t),h(R(s.value)))}},b=()=>{l&&f.deltaY.value&&S()&&(n.duration=+e.animationDuration,n.status==="loosing"?(h(+e.headHeight,!0),m("update:modelValue",!0),V(()=>m("refresh"))):h(0))};return H(()=>e.modelValue,t=>{n.duration=+e.animationDuration,t?h(+e.headHeight,!0):o.success||e.successText?v():h(0,!1)}),()=>{var t;const s={transitionDuration:`${n.duration}ms`,transform:n.distance?`translate3d(0,${n.distance}px, 0)`:""};return c("div",{ref:d,class:$()},[c("div",{class:$("track"),style:s,onTouchstart:r,onTouchmove:g,onTouchend:b,onTouchcancel:b},[c("div",{class:$("head"),style:a()},[i()]),(t=o.default)==null?void 0:t.call(o)])])}}});const Pe=C(me);export{De as L,ke as N,Pe as P};
